<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SBB Clock</title>
  <script src="sbbUhr-1.3.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }

    #clock-container {
      width: 100vw;
      height: 100vh;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="clock-container"></div>

<script>
  (function () {
    let offset = 0;

    function fetchWithTimeout(url, timeout = 2000) {
      return Promise.race([
        fetch(url).then(res => res.json()),
        new Promise((_, reject) =>
          setTimeout(() => reject(new Error('Timeout')), timeout)
        )
      ]);
    }

    async function getTimeOffset() {
      try {
        const data = await fetchWithTimeout('https://worldtimeapi.org/api/ip');
        const serverTime = new Date(data.datetime).getTime();
        const localTime = Date.now();
        offset = serverTime - localTime;
        console.log('Offset (ms):', offset);
        return data.timezone;  // ritorna anche il fuso orario
      } catch {
        console.log('Fetch fallita, uso orario locale');
        offset = 0;
        return Intl.DateTimeFormat().resolvedOptions().timeZone; // fuso locale
      }
    }

    getTimeOffset().then(timezone => {
      // Override ora per sbbUhr, con offset corretto
